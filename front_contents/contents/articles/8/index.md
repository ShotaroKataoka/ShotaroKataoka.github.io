---
description: 'かたおかです。 いわゆるFOUCってやつですか。 よくわかってないですが初期レンダリングまでにCSSが読み込まれてないせいでリロード後一瞬だけページ表示が崩れてしまいます。
  このサイトもリロードするとちらちらして鬱陶しいのでどうにか直せないか試行錯誤してみます。  ## 試行錯誤１ - _document.tsxを作る `_document.tsx`を作って`EmotionCache`をしてみます...'
posted_at: 2022-06-28 02:17:00+00:00
slug: '8'
tag_ids:
- 4263726428
- 4263728284
- 4263728970
title: Next.js + MUIで画面がちらつく（FOUC問題）
updated_at: 2022-06-29 01:38:00+00:00

---
かたおかです。
いわゆるFOUCってやつですか。
よくわかってないですが初期レンダリングまでにCSSが読み込まれてないせいでリロード後一瞬だけページ表示が崩れてしまいます。
このサイトもリロードするとちらちらして鬱陶しいのでどうにか直せないか試行錯誤してみます。

## 試行錯誤１ - _document.tsxを作る
`_document.tsx`を作って`EmotionCache`をしてみます。
あまり理解してないですがサーバサイドレンダリングをうまく使って改善できるらしいです。
<br/>

-> 結果
なんか若干良くなった気はする……？
ただまだちらつきはする
Swiperとか使っててJSが重いページの方が症状は重そう
逆に記事ページみたいなSwiper使ってないページはちらつきにくくなった
JSの適用とCSSの適用にずれがある？？
こっからどうすりゃいいんだー？

## 試行錯誤２ - コンポーネントを読み込み完了するまで非表示する

https://qiita.com/cawauchi/items/165f71cf67e90279a5d7

↑のサイトを参考にした。
`useEffect`が呼ばれるまでコンポーネントを表示しないので（おそらく）崩れることはなくなるはず。
欠点としては読み込みが遅いページだと画面の初期表示まで時間がかかることかな？
ちらつくよりは全然いいので試してみる！
<br/>

-> 結果
できた！！！
リロードしても画面ちらつかなくなった！

## まとめ
試行錯誤でやったのでベストプラクティスではないかもですが、以下試しました。
- `_document.tsx`で`EmotionCache`とかを使う。
- `_app.tsx`でコンポーネント読み込み完了までページの要素を非表示にする。

基本的に2点目を使えば解決はしそうですね。

では
