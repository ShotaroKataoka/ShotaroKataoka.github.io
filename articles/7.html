<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="initial-scale=1, width=device-width"/><title>GitHub Actionsでビルドを高速化をしたい！ | かたおかの雑談配信</title><meta name="description" content="かたおかです１ RibbonCMSではPythonとNPMを使っているのでビルド時の依存関係のインストールに時間がかかります。 記事投稿に毎回数分かかるとめんどうなのでどうにかキャッシュできないかをテストしてみます。  ## ビルド時間の短縮 GitHub ActionsでのCI/CDでは依存関係インストールがつきものです。 Pythonだと`pip`とか，フロントだと`npm`とか。 ただ，これ..."/><link rel="icon" href="https://ShotaroKataoka.github.io/static/images/favicon.ico"/><meta property="og:title" content="GitHub Actionsでビルドを高速化をしたい！ | かたおかの雑談配信"/><meta property="og:description" content="かたおかです１ RibbonCMSではPythonとNPMを使っているのでビルド時の依存関係のインストールに時間がかかります。 記事投稿に毎回数分かかるとめんどうなのでどうにかキャッシュできないかをテストしてみます。  ## ビルド時間の短縮 GitHub ActionsでのCI/CDでは依存関係インストールがつきものです。 Pythonだと`pip`とか，フロントだと`npm`とか。 ただ，これ..."/><meta property="og:image" content="https://ShotaroKataoka.github.io/static/images/thumbnail/7.jpg"/><meta property="og:type" content="article"/><meta property="og:site_name" content="かたおかの雑談配信"/><meta property="og:url" content="https://ShotaroKataoka.github.io/article/7"/><meta name="twitter:image" content="https://ShotaroKataoka.github.io/static/images/thumbnail/7.jpg"/><meta name="twitter:card" content="summary_large_image"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"/><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/af16e0fa0c206764.css" as="style"/><link rel="stylesheet" href="/_next/static/css/af16e0fa0c206764.css" data-n-g=""/><link rel="preload" href="/_next/static/css/6d54c7d60751f978.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6d54c7d60751f978.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-df4cf1c8d23aa877.js" defer=""></script><script src="/_next/static/chunks/framework-a87821de553db91d.js" defer=""></script><script src="/_next/static/chunks/main-fc7d2f0e2098927e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-82c12094935b23b2.js" defer=""></script><script src="/_next/static/chunks/b5f2ed29-08db60af0c3043ba.js" defer=""></script><script src="/_next/static/chunks/563-dd2ef6f154fd9f09.js" defer=""></script><script src="/_next/static/chunks/121-ea82cf503e383d52.js" defer=""></script><script src="/_next/static/chunks/475-cb6e074afa978e65.js" defer=""></script><script src="/_next/static/chunks/219-8892efd382471043.js" defer=""></script><script src="/_next/static/chunks/359-6cf4c32ec6144182.js" defer=""></script><script src="/_next/static/chunks/pages/articles/%5Bslug%5D-c2ee7ae72f3ec5ba.js" defer=""></script><script src="/_next/static/5pVRT8ou8L9YRGBVjduSM/_buildManifest.js" defer=""></script><script src="/_next/static/5pVRT8ou8L9YRGBVjduSM/_ssgManifest.js" defer=""></script><script src="/_next/static/5pVRT8ou8L9YRGBVjduSM/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><style data-emotion="css-global 1ii3po4">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:rgba(0, 0, 0, 0.87);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-weight:400;font-size:1rem;line-height:1.5;background-color:#F0ECE0;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#F0ECE0;}</style><div><main><div><div><header class="MuiPaper-root MuiPaper-elevation MuiPaper-elevation0 MuiAppBar-root MuiAppBar-colorInherit MuiAppBar-positionFixed mui-fixed css-10xzvcb"><div class="MuiContainer-root MuiContainer-maxWidthMd css-1c0cfyw"><div class="MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-i6s8oy"><div class="MuiGrid-root MuiGrid-container css-1d3bbye"><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-2 css-o0rlmm"><div><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-1bs1cg1" tabindex="0" type="button" aria-label="Open Sidebar"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="MenuIcon"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg></button></div></div><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-10 css-1v3pb4k"><a class="MuiTypography-root MuiTypography-h3 css-vc39qc" href="/">かたおかの雑談配信</a></div></div></div></div></header></div><div class="MuiBox-root css-ebjf8f"></div></div><div class="MuiContainer-root MuiContainer-maxWidthMd css-1c0cfyw"><div><h1 class="MuiTypography-root MuiTypography-h1 MuiTypography-alignCenter css-1ewnmev">GitHub Actionsでビルドを高速化をしたい！</h1><p class="MuiTypography-root MuiTypography-body1 MuiTypography-alignCenter css-1a51bv2">2022年06月27日 20時43分<!-- -->に公開<!-- --></p><p class="MuiTypography-root MuiTypography-body1 MuiTypography-alignCenter css-1o3ep24">2022年06月27日 20時56分<!-- -->に更新<!-- --></p><div class="MuiBox-root css-yuob64"></div><div class="MuiBox-root css-9pqysf"><div class="MuiGrid-root MuiGrid-container css-1d3bbye"><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-10.3 MuiGrid-grid-sm-11.3 css-1aeqyrk"><div class="MuiBox-root css-0"><div class="MuiBox-root css-h50031"><a class="MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButtonBase-root  css-14n541y" tabindex="0" href="/articles?tag=%E9%96%8B%E7%99%BA">開発<!-- --></a></div><div class="MuiBox-root css-h50031"><a class="MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButtonBase-root  css-5mab4u" tabindex="0" href="/articles?tag=RibbonCMS">RibbonCMS<!-- --></a></div></div></div><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-1.7 MuiGrid-grid-sm-0.7 css-1bn5q8u"><a class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-1yxmbwk" tabindex="0" href="https://github.com/ShotaroKataoka/ShotaroKataoka.github.io/issues/7" target="_blank" rel="noopener" aria-label="edit page"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeSmall css-1k33q06" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="EditIcon"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"></path></svg></a></div></div><div class="MuiBox-root css-yuob64"></div><div><div class="MuiTypography-root MuiTypography-body1 css-1tnm47n">かたおかです１<!-- --><br/>
RibbonCMSではPythonとNPMを使っているのでビルド時の依存関係のインストールに時間がかかります。<!-- --><br/>
記事投稿に毎回数分かかるとめんどうなのでどうにかキャッシュできないかをテストしてみます。<!-- --></div>
<!-- --><h2 id="ビルド時間の短縮"><div class="MuiBox-root css-174dpmb"><div class="MuiGrid-root MuiGrid-container css-1d3bbye"><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-0.5 css-1xsopoz"></div><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-1.5 css-1chpm7x"><a class="MuiTypography-root MuiTypography-h2 MuiLink-root MuiLink-underlineHover css-haf4zu" href="/articles/7#%E3%83%93%E3%83%AB%E3%83%89%E6%99%82%E9%96%93%E3%81%AE%E7%9F%AD%E7%B8%AE">##</a></div><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-10 css-1v3pb4k"><div class="MuiTypography-root MuiTypography-h2 css-2hyyus">ビルド時間の短縮</div></div></div><hr class="MuiDivider-root MuiDivider-fullWidth MuiDivider-textAlignLeft css-ztfl0h"/></div></h2>
<!-- --><div class="MuiTypography-root MuiTypography-body1 css-1tnm47n">GitHub ActionsでのCI/CDでは依存関係インストールがつきものです。<!-- --><br/>
Pythonだと<!-- --><div class="MuiBox-root css-dm2a2d">pip<!-- --></div>とか，フロントだと<!-- --><div class="MuiBox-root css-dm2a2d">npm<!-- --></div>とか。<!-- --><br/>
ただ，これのインストールって結構時間かかります。<!-- --><br/>
依存が大きいとインストールだけで数分とかかかってしまうので，頻繁に発動するActionsだとこれだけで大きな時間損失です。<!-- --><br/>
<!-- --><br/></div>
<!-- --><div class="MuiTypography-root MuiTypography-body1 css-1tnm47n">RibbonCMSではビルドを2回行います。<!-- --><br/>
まず、Issueを<!-- --><div class="MuiBox-root css-dm2a2d">.json<!-- --></div>ファイルなどに変換するためのビルド（Issueビルドと呼んでます）です。<!-- --><br/>
これはPythonを用いて行っています。<!-- --><br/>
次に、Issueビルドで生成した結果をもとにしたフロント側のビルドです。<!-- --><br/>
これによりNext.jsを用いてhtmlなどを生成しています。<!-- --><br/>
<!-- --><br/></div>
<!-- --><div class="MuiTypography-root MuiTypography-body1 css-1tnm47n">このような仕組みのため、RibbonCMSではGitHub ActionsPythonとNPMの両方のパッケージインストールを必要としています。<!-- --><br/>
記事投稿や編集のために毎回これをしているので，このインストール時間がかなりネックになってしまっている現状です。<!-- --></div></div></div></div><div><div class="MuiDivider-root MuiDivider-fullWidth MuiDivider-withChildren css-ysfq67" role="separator"><span class="MuiDivider-wrapper css-c1ovea"><h2 class="MuiTypography-root MuiTypography-h2 css-1m3ios">Related articles</h2></span></div><div class="MuiGrid-root MuiGrid-container css-1d3bbye"><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-6 css-rpybyc"><div class="MuiBox-root css-1y8t6b0"><div class="MuiPaper-root MuiPaper-outlined MuiPaper-rounded MuiCard-root css-1npetu3"><a class="MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium MuiButtonBase-root  css-1vffthx" tabindex="0" href="/articles/5"><div class="MuiBox-root css-y2xfrj"><img class="MuiCardMedia-root MuiCardMedia-media MuiCardMedia-img css-rhsghg" src="https://ShotaroKataoka.github.io/static/images/thumbnail/5.jpg" alt="thumbnail"/><div class="MuiBox-root css-18m647v"><div class="MuiTypography-root MuiTypography-body2 MuiTypography-gutterBottom css-ich5ml">2022年06月24日 14時24分</div><div class="MuiTypography-root MuiTypography-h2 css-jezswg">汎用版RibbonCMS完成！</div></div></div></a><div class="MuiContainer-root MuiContainer-maxWidthLg css-1qsxih2"><div class="MuiBox-root css-7ux9eu"><div class="MuiBox-root css-0"><div class="MuiBox-root css-h50031"><a class="MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButtonBase-root  css-qvy0nq" tabindex="0" href="/articles?tag=star">star<!-- --></a></div><div class="MuiBox-root css-h50031"><a class="MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButtonBase-root  css-14n541y" tabindex="0" href="/articles?tag=%E9%96%8B%E7%99%BA">開発<!-- --></a></div><div class="MuiBox-root css-h50031"><a class="MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButtonBase-root  css-5mab4u" tabindex="0" href="/articles?tag=RibbonCMS">RibbonCMS<!-- --></a></div><div class="MuiBox-root css-h50031"><a class="MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButtonBase-root  css-1hbyurq" tabindex="0" href="/articles?tag=Next.js">Next.js<!-- --></a></div></div></div></div></div></div></div><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-6 css-rpybyc"><div class="MuiBox-root css-1y8t6b0"><div class="MuiPaper-root MuiPaper-outlined MuiPaper-rounded MuiCard-root css-1npetu3"><a class="MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium MuiButtonBase-root  css-1vffthx" tabindex="0" href="/articles/2"><div class="MuiBox-root css-y2xfrj"><img class="MuiCardMedia-root MuiCardMedia-media MuiCardMedia-img css-rhsghg" src="https://ShotaroKataoka.github.io/static/images/thumbnail/2.jpg" alt="thumbnail"/><div class="MuiBox-root css-18m647v"><div class="MuiTypography-root MuiTypography-body2 MuiTypography-gutterBottom css-ich5ml">2022年06月23日 15時02分</div><div class="MuiTypography-root MuiTypography-h2 css-jezswg">テスト投稿</div></div></div></a><div class="MuiContainer-root MuiContainer-maxWidthLg css-1qsxih2"><div class="MuiBox-root css-7ux9eu"><div class="MuiBox-root css-0"><div class="MuiBox-root css-h50031"><a class="MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButtonBase-root  css-jydqma" tabindex="0" href="/articles?tag=%E6%97%A5%E8%A8%98">日記<!-- --></a></div><div class="MuiBox-root css-h50031"><a class="MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButtonBase-root  css-5mab4u" tabindex="0" href="/articles?tag=RibbonCMS">RibbonCMS<!-- --></a></div></div></div></div></div></div></div><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-6 css-rpybyc"><div class="MuiBox-root css-1y8t6b0"><div class="MuiPaper-root MuiPaper-outlined MuiPaper-rounded MuiCard-root css-1npetu3"><a class="MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium MuiButtonBase-root  css-1vffthx" tabindex="0" href="/articles/6"><div class="MuiBox-root css-y2xfrj"><img class="MuiCardMedia-root MuiCardMedia-media MuiCardMedia-img css-rhsghg" src="https://ShotaroKataoka.github.io/static/images/thumbnail/6.jpg" alt="thumbnail"/><div class="MuiBox-root css-18m647v"><div class="MuiTypography-root MuiTypography-body2 MuiTypography-gutterBottom css-ich5ml">2022年06月26日 17時43分</div><div class="MuiTypography-root MuiTypography-h2 css-jezswg">サムネイルのテスト！</div></div></div></a><div class="MuiContainer-root MuiContainer-maxWidthLg css-1qsxih2"><div class="MuiBox-root css-7ux9eu"><div class="MuiBox-root css-0"><div class="MuiBox-root css-h50031"><a class="MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButtonBase-root  css-jydqma" tabindex="0" href="/articles?tag=%E6%97%A5%E8%A8%98">日記<!-- --></a></div></div></div></div></div></div></div></div></div></div></main><footer><div class="MuiBox-root css-i51og3"><p class="MuiTypography-root MuiTypography-body2 MuiTypography-alignCenter css-dw7fc9">Copyright © <!-- --><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways css-1c0wj8h" href="https://github.com/ShotaroKataoka" target="_blank" rel="noopener">ShotaroKataoka</a> <!-- -->2022<!-- -->.<!-- --></p></div></footer></div><div class="MuiBox-root css-175t7kh"></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"7","content":"かたおかです１\nRibbonCMSではPythonとNPMを使っているのでビルド時の依存関係のインストールに時間がかかります。\n記事投稿に毎回数分かかるとめんどうなのでどうにかキャッシュできないかをテストしてみます。\n\n## ビルド時間の短縮\nGitHub ActionsでのCI/CDでは依存関係インストールがつきものです。\nPythonだと`pip`とか，フロントだと`npm`とか。\nただ，これのインストールって結構時間かかります。\n依存が大きいとインストールだけで数分とかかかってしまうので，頻繁に発動するActionsだとこれだけで大きな時間損失です。\n\u003cbr/\u003e\n\nRibbonCMSではビルドを2回行います。\nまず、Issueを`.json`ファイルなどに変換するためのビルド（Issueビルドと呼んでます）です。\nこれはPythonを用いて行っています。\n次に、Issueビルドで生成した結果をもとにしたフロント側のビルドです。\nこれによりNext.jsを用いてhtmlなどを生成しています。\n\u003cbr/\u003e\n\nこのような仕組みのため、RibbonCMSではGitHub ActionsPythonとNPMの両方のパッケージインストールを必要としています。\n記事投稿や編集のために毎回これをしているので，このインストール時間がかなりネックになってしまっている現状です。\n","title":"GitHub Actionsでビルドを高速化をしたい！","posted_at":"2022年06月27日 20時43分","updated_at":"2022年06月27日 20時56分","tags":[{"name":"開発","color":"bfd4f2","description":""},{"name":"RibbonCMS","color":"fff03c","description":""}],"description":"かたおかです１ RibbonCMSではPythonとNPMを使っているのでビルド時の依存関係のインストールに時間がかかります。 記事投稿に毎回数分かかるとめんどうなのでどうにかキャッシュできないかをテストしてみます。  ## ビルド時間の短縮 GitHub ActionsでのCI/CDでは依存関係インストールがつきものです。 Pythonだと`pip`とか，フロントだと`npm`とか。 ただ，これ..."},"config":{"blog_title":"かたおかの雑談配信","site_introduction":"かたおかのブログです。主に趣味関係をだらだら書いていきます。日本文化が好きです。","copylight_name":"ShotaroKataoka","copylight_url":"https://github.com/ShotaroKataoka","issues_page_url":"https://github.com/ShotaroKataoka/ShotaroKataoka.github.io/issues","favicon_image_url":"https://user-images.githubusercontent.com/42331656/175220729-c255f8b0-e709-4efc-a8e6-dc2e29a92c35.png","author_name":"かたおか","author_introduction":"かたおかです。アイコンはみかん。","avatar_image_url":{"url":"https://user-images.githubusercontent.com/42331656/175183205-06dc6033-af20-44b9-ae3d-c3e68770a1f3.png","path":"/static/images/config/avatar.webp"},"sns":[{"name":"GitHub","url":"https://github.com/ShotaroKataoka"},{"name":"Twitter","url":"https://twitter.com/KataokaShotaro"},{"name":"Facebook","url":"https://www.facebook.com/profile.php?id=100014221270440"},{"name":"LinkedIn","url":"https://www.linkedin.com/in/shotarokataoka/"},{"name":"Instagram","url":"https://www.instagram.com/s.kataoka_/?hl=ja"}]},"postsMap":{"2":{"slug":"2","title":"テスト投稿","tags":[{"name":"日記","color":"006b75","description":""},{"name":"RibbonCMS","color":"fff03c","description":""}],"posted_at":"2022年06月23日 15時02分","content":"","updated_at":"","description":""},"5":{"slug":"5","title":"汎用版RibbonCMS完成！","tags":[{"name":"star","color":"fbca04","description":""},{"name":"開発","color":"bfd4f2","description":""},{"name":"RibbonCMS","color":"fff03c","description":""},{"name":"Next.js","color":"E63EC8","description":""}],"posted_at":"2022年06月24日 14時24分","content":"","updated_at":"","description":""},"6":{"slug":"6","title":"サムネイルのテスト！","tags":[{"name":"日記","color":"006b75","description":""}],"posted_at":"2022年06月26日 17時43分","content":"","updated_at":"","description":""}},"metadata":{},"relatedPosts":[{"slug":"5","title":"汎用版RibbonCMS完成！","tags":[{"name":"star","color":"fbca04","description":""},{"name":"開発","color":"bfd4f2","description":""},{"name":"RibbonCMS","color":"fff03c","description":""},{"name":"Next.js","color":"E63EC8","description":""}],"posted_at":"2022年06月24日 14時24分","content":"","updated_at":"","description":""},{"slug":"2","title":"テスト投稿","tags":[{"name":"日記","color":"006b75","description":""},{"name":"RibbonCMS","color":"fff03c","description":""}],"posted_at":"2022年06月23日 15時02分","content":"","updated_at":"","description":""},{"slug":"6","title":"サムネイルのテスト！","tags":[{"name":"日記","color":"006b75","description":""}],"posted_at":"2022年06月26日 17時43分","content":"","updated_at":"","description":""}]},"__N_SSG":true},"page":"/articles/[slug]","query":{"slug":"7"},"buildId":"5pVRT8ou8L9YRGBVjduSM","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>