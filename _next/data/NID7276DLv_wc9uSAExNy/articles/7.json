{"pageProps":{"post":{"slug":"7","content":"かたおかです！\nRibbonCMSではPythonとNPMを使っているのでビルド時の依存関係のインストールに時間がかかります。\n記事投稿に毎回数分かかるとめんどうなのでどうにかキャッシュできないかをテストしてみます。\n\n## ビルド時間の短縮\nGitHub ActionsでのCI/CDでは依存関係インストールがつきものです。\nPythonだと`pip`とか，フロントだと`npm`とか。\nただ，これのインストールって結構時間かかります。\n依存が大きいとインストールだけで数分とかかかってしまうので，頻繁に発動するActionsだとこれだけで大きな時間損失です。\n<br/>\n\nRibbonCMSではビルドを2回行います。\nまず、Issueを`.json`ファイルなどに変換するためのビルド（Issueビルドと呼んでます）です。\nこれはPythonを用いて行っています。\n次に、Issueビルドで生成した結果をもとにしたフロント側のビルドです。\nこれによりNext.jsを用いてhtmlなどを生成しています。\n<br/>\n\nこのような仕組みのため、RibbonCMSではPythonとNPMの両方のパッケージインストールを必要としています。\n記事投稿や編集のために毎回これをしているので，このインストール時間がかなりネックになってしまっている現状です。\n\n## なんか失敗する．．\n\n`Cache not found for input keys: ` といわれnpmのキャッシュ利用がなんか失敗した。\n↓記事を見る限り，キャッシュの保存に失敗してる様子\n\nhttps://qiita.com/akubi0w1/items/2f4bf5d3ce7e5e77dfd7\n\nあ！`actions/cache`の`path`が間違ってそう・・・？\n```yaml\n    - uses: actions/cache@v3\n      id: node_modules_cache_id\n      env:\n        cache-name: cache-node-modules\n      with:\n        path: 'src/node_modules'\n        key: ${{ runner.os }}-build-${{ env.cache-name }}-${{ hashFiles('front/src/package-lock.json') }}\n```\n正しくは，`path: front/src/node_modules`かな？\nこれでうまくいってくれ・・・！\n\n## cache読み込めてそうだけど早くならない\ncache読み込んだらインストールしないようにすべき？\nやってみる\n-> 単純にインスト―ルしないようにするとエラーになった\ncacheリストアだけだとやっぱりpipが読み込めていないぽい\n<br/>\n\nvenvをcacheしてみよう。\nこれならいけるやろ！\n<br/>\n\n->\nModuleNotFoundになった😢\nvenvのactivateを毎回やらないとだめっぽい。\nPython実行前に毎stepでactivateしてみる。\n","title":"GitHub Actionsでビルドを高速化したい！","posted_at":"2022年06月27日 20時43分","updated_at":"2022年06月28日 00時12分","tags":[{"name":"開発","color":"bfd4f2","description":""},{"name":"RibbonCMS","color":"fff03c","description":""}],"description":"かたおかです！ RibbonCMSではPythonとNPMを使っているのでビルド時の依存関係のインストールに時間がかかります。 記事投稿に毎回数分かかるとめんどうなのでどうにかキャッシュできないかをテストしてみます。  ## ビルド時間の短縮 GitHub ActionsでのCI/CDでは依存関係インストールがつきものです。 Pythonだと`pip`とか，フロントだと`npm`とか。 ただ，これ..."},"config":{"blog_title":"かたおかの雑談配信","site_introduction":"かたおかのブログです。主に趣味関係をだらだら書いていきます。日本文化が好きです。","copylight_name":"ShotaroKataoka","copylight_url":"https://github.com/ShotaroKataoka","issues_page_url":"https://github.com/ShotaroKataoka/ShotaroKataoka.github.io/issues","favicon_image_url":"https://user-images.githubusercontent.com/42331656/175220729-c255f8b0-e709-4efc-a8e6-dc2e29a92c35.png","author_name":"かたおか","author_introduction":"かたおかです。アイコンはみかん。","avatar_image_url":{"url":"https://user-images.githubusercontent.com/42331656/175183205-06dc6033-af20-44b9-ae3d-c3e68770a1f3.png","path":"/static/images/config/avatar.webp"},"sns":[{"name":"GitHub","url":"https://github.com/ShotaroKataoka"},{"name":"Twitter","url":"https://twitter.com/KataokaShotaro"},{"name":"Facebook","url":"https://www.facebook.com/profile.php?id=100014221270440"},{"name":"LinkedIn","url":"https://www.linkedin.com/in/shotarokataoka/"},{"name":"Instagram","url":"https://www.instagram.com/s.kataoka_/?hl=ja"}]},"postsMap":{"2":{"slug":"2","title":"テスト投稿","tags":[{"name":"日記","color":"006b75","description":""},{"name":"RibbonCMS","color":"fff03c","description":""}],"posted_at":"2022年06月23日 15時02分","content":"","updated_at":"","description":""},"5":{"slug":"5","title":"汎用版RibbonCMS完成！","tags":[{"name":"star","color":"fbca04","description":""},{"name":"開発","color":"bfd4f2","description":""},{"name":"RibbonCMS","color":"fff03c","description":""},{"name":"Next.js","color":"E63EC8","description":""}],"posted_at":"2022年06月24日 14時24分","content":"","updated_at":"","description":""},"6":{"slug":"6","title":"サムネイルのテスト！","tags":[{"name":"日記","color":"006b75","description":""}],"posted_at":"2022年06月26日 17時43分","content":"","updated_at":"","description":""}},"metadata":{"https://qiita.com/akubi0w1/items/2f4bf5d3ce7e5e77dfd7":{"url_domain":"qiita.com","url_domain_link":"https://qiita.com","title":"GitHub Actionsのcacheでどハマりした - Qiita","description":"\n\nはじめに\n\nタイトルそのままのことがおこりました。\n\n4/15追記: 今回ハマったこと自体は、原因がわかり、形的に成功しているように見えるのですが、8割解決してないです。\nこちらも合わせてどうぞ...。\nGitHub Action...","image_url":"/static/images/external_ogp//f6c4804976e9c023caa6f5e40aa4d283.webp","site_name":"Qiita"}},"relatedPosts":[{"slug":"5","title":"汎用版RibbonCMS完成！","tags":[{"name":"star","color":"fbca04","description":""},{"name":"開発","color":"bfd4f2","description":""},{"name":"RibbonCMS","color":"fff03c","description":""},{"name":"Next.js","color":"E63EC8","description":""}],"posted_at":"2022年06月24日 14時24分","content":"","updated_at":"","description":""},{"slug":"2","title":"テスト投稿","tags":[{"name":"日記","color":"006b75","description":""},{"name":"RibbonCMS","color":"fff03c","description":""}],"posted_at":"2022年06月23日 15時02分","content":"","updated_at":"","description":""},{"slug":"6","title":"サムネイルのテスト！","tags":[{"name":"日記","color":"006b75","description":""}],"posted_at":"2022年06月26日 17時43分","content":"","updated_at":"","description":""}]},"__N_SSG":true}